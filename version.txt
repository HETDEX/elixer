changes to elixer by version


1.5.0a20 [2019-02-25] [branched to hdr1]
* updated the catalogs API to allow operator to specify an aperture for a magnitude calcuation and whether that
  aperture is dynamic
* updated the catalogs API to take radius as arcsecs rather than degrees (though if less than 0.5, will assume degrees)
* fixed bug in calcuation of sky subtraction annulus (outer radius) into pixel space
* updated --ra --dec --error on command line to search for HDF5 detections and perform full ELiXer report on each


1.5.0a19 [2019-02-20]
* bumped local sky annulus for forced aperture photometry to 5x (inner) to 10x (outer) of the aperture radius
  (roughly 75x more sky pixels than source pixels) ... makes very little difference in magnitude (order 0.1 - 0.2 mag)
  (I think becuase the images are already well sky subtracted)

1.5.0.a18 [2019-02-19]
* fixed left-over 'sci_image' reference in cat_xxx.py count_to_mag functions
* add HDF5 support (path to multi-fits still hardcoded)
* scale upper right (model fit) plot to the central 50% of the datapoints
* explicitly cast x and y data to scipy.curve_fit as np.float64 to deal with precision issue in scipy implementation
* moved bin width (for flux vs flux/dx) as part of Gaussian parameters to track model area vs actual line_flux separately


1.5.0.a17 [2019-02-03]
* updates to selixer.py to deal with (minimum func) wrangler and stampede2
* added API for imaging catalogs (cutouts and catalog detections)
  + add cut2fits.py as command line python app to save cutouts as FITS
* reworked catalogs to minimize memory usage on loading larger FITS for imaging cutouts and add retries


1.5.0a16 [2019-01-02]
* incorporated Daniel Farrow's version of the Bayesian line discriminator (currently calling both versions and logging
    a warning if there is a > 1% discrepency between them)
* including line flux and eq.width uncertainties in calls the Bayesian discriminator for HETDEX data (not yet including
    uncertainties from external imaging catalogs as (1) do not have error frames and (2) assuming Poisson error at
    the pixel level might not be appropriate)
* fixed error in propogating line flux and continuum uncertainties into equivalent width uncertainty if using local
  MCMC fit
* updated SLURM wrapper to allow for maverick or wrangler
* fixed missing columns in dataframe for stack_cosmos (was missing the FLUX_AUTO and FLUXERR_AUTO) to add per filter
  flux to the catalog


1.5.0a15 [2018-12-14]
* changed IFUSLOT_ID back to SPECID in the text to the right of the 2D cutouts (the multi*fits are named starting
  with the SPECID so that makes the file easier to find)
* dispaly (top left) SpecID and SlotID of the primary fiber's IFU
* added command line option --include_all_amps which overrides the Bad Amp List and forces all amps to be processed
* fixed string representation of value +/- uncertainties for small exponents (upper left text)

1.5.0a14 [2018-12-13]
* if aperture magnitude fainter than global_config::SKY_ANNULUS_MIN_MAG, then compute local sky in 2x radius annulus
   around the original source, subtract sky and recompute magnitude
* add DS9 x,y back to the data to the right of the 2D CCD cutouts (top center),
  changed last line to be IFUSLOT_ID AMP Fiber_Index  (was SPECID AMP Fiber_Index),
  and made font black for all data
* add support for bad_amp_list (consists of ifuslot amp start_date stop_date)
* fixed typo in header for *_fibs.txt (was not printing the 16th column header correctly as the number of fibers)

1.5.0a13 [2018-12-10]
* fixed bug for non-measured continuum and reporting of P(LAE)/P(OII) in cat_shela

1.5.0a12 [2018-12-07]
* made photometry aperture fixed at 1.5" (not yet configurable on command line, but is set in global_config.py)
* switching preferred filter to compute continuum estimate to r-band
* fix missing SNR (col 13) in *_cat.txt

1.5.0a11 [2018-11-28]
* corrected error in hetdex.py load_fluxcalibrated_spectra (wrong column being used for sigma from fitres *.res files)

1.5.0a10 [2018-11-13]
* added fullname / PDF name to catalogs as 1st column
* if fcsdir is provided and the final node directory is an rspxxx output, will build PDF filename from the dirname

1.5.0a9 [2018-11-08]
* changed entry ID to allow it to be a string (if just numerical, will still treat as an integer)
* hetdex.py::load_fluxcalibrated_spectra deal with l1,l6 files of only one line (ndarray.size issue vs len())

1.5.0a8 [2018-11-08]
* changed search for an entry ID from the fcsdir detection file path to use the last token that is an integer

1.5.0a7 [2018-11-07]
* removed Sky X, Y (weighted X,Y of the source in the IFU) from *_fib.txt
* added IFU X, Y (X,Y of the center of the fiber in the IFU) for each fiber in *_fib.txt

1.5.0a6 [2018-11-06]
* adjust rspxxx Gauss fit of line flux by 2x (pixels to angstroms correction)
* replace upper right dataplot as scatter with error vs line with error

1.5.0a5[2018-10-25]
* use local *.res (if fails, check for ../fitres/*.res (hetdex::load_fluxcalibrated_spectra)
* incorporate AMPLIFIE or AMPNAME for additional flip logic for pixel flats
* more work on ANNULUS


1.5.0a4 [2018-10-19]
* updating for changes to rsp output
* moved initialization of logger to after check for --help
* fixed summing problem with Cutout2D.data in catalogs get_stacked_cutout
* added global option to use (or not) ELiXer internal MCMC fit for main line and uncertainties


1.5.0a3 [2018-10-17]
* allow --fcsdir directory building with --dets to continue if individual directories are bad
* changed upper right panel to display best Gaussian fit instead of summed fibers if fit parameters are available
* added Subarau HSC g-band COSMOS image to stackCOSMOS catalog
* zero out regions in 2D CCD cutouts where pixel flat is < 0

1.5.0a2 [2018-10-10]
* updated to new rsp1xx output (*specf.dat), remove *spece.dat
* use internal MCMC for uncertainties
* working on incorporating per wavelength noise model for simulated noise only spectra


1.5.0a1 [2018-08-30]
* support for stacking empty fibers (diffuse/extended emission search)
* adding in --annulus, --wavelength


1.4.0 [2018-08-11] promoted version 1.4.0a11 to release to avoid active user collisions

1.4.0a11 [2018-07-30]
* still produce full sized PDF even if multi*fits files cannot be located or imported (use empty spacing)

* support for tar (reduced data)

* building toward summing fibers (for diffuse emission).
    Add: SyntheticObservation (observation.py)

* added (somewhat hand-wavy) absorption line features to scoring by inverting the spectra and fitting for emission.
  Scores from these features down-scaled to 80% of an equivalent (true) emission line

* added MCMC output (corner plot) of fit paramters of main line (as mcmc_eid(*)_*.png )

* added overplot of MCMC fit to main line gauss*.png (as a 'highlight')

* added --tasks option to allow for multiple tasks in TACC SLURM call


1.4.0a10 [2018-07-27]
* changing project name (and supporting files/references) from voltron to elixer


1.4.0a9 [2018-07-27]
* add MCMC fitting of gaussian (can be used on any line, but currently just on main line and currently only logged)
  (note: testing shows close agreement with scipy curve_fit, so for the additional lines, just use curve_fit as it
   is much faster ... for the main line use MCMC as it provides the estimated distribution (uncertainties) in the
   parameters)

* fixed bug where rsp1 calculated line flux data was being read in units of e-18 instead of e-17

* modified Bayes.basyesian.prob_data_given_OII and prob_data_given_LAE to incorporate uncertainties in the lineflux and
  EqW_obs if known (otherwise defaults back to the previous +/- 5%)


1.4.0a8 [2018-07-05]
* Updated with Isak's new SHELA cats and images

* Updated to cat_shela to only load one tile at a time (as needed) rather than all tiles up front
  (note: photoZ catalog is not by tile, however, and is loaded up front and still takes a while)

* Updated science_image.py to deal with change in astropy and photutils adding units to aperture counts

* Updated science_image.py to use pixel based aperture photometry first (much faster) and switch to sky coord based
  (needs the whole image for WCS) if it fails.


1.4.0a7 [2018-06-25]
* fixed bug where CFHTLS catalog magnitude was not being calculated from flux (resulting in exception in print statement)

* fixed bug where list of matched catalogs was not being tracked per emission line object (could cause empty cutouts if
  detections are from different sky regions with separate catalogs)

* reduced overlapping emission line labels in full 1D plot (only display "major" lines and those that have a match in
  the multiline solution)


1.4.0a6 [2018-06-19]
* add 1 - probability of noise "confidence" to multiline solution
    - use skewed Gaussian noise model with 1e5 samples
    - use SNR * Line_flux as score
    - for 1.0 wide score bins for each emission line, get the prob that it is noise
    - solution confidence = 1.0 - product of each emission line prob(noise)
    - (note: noise only ... does not explicitly deal with partially removed cosmic rays, etc)

* update cat_bayesian (probability of random catalog match) to allow caller selection of MDF vs pseudo-PDF and
  whether or not to integrate over the distance +/- astrometry error (and bin-width).
  Default is pseduo-PDF with integration and assumed error of 0.5"



1.4.0a5 [2018-06-12]
* added dashed lines to indicate possible emission lines in full 1D spectra plot

* fixed bug where PDF displayed EW_rest was EW_obs/z instead of EW_obs/(1+z)

* improvements and tuning on matching detected peaks to additional line positions based on primary emission line

* added best_z, best_confidence, lists of all lines, lines used in classification to *_cat.txt

1.4.0a4 [2018-06-08]
* fit sigmoid and variable degree polynomial (default=3 and better fit) to probability of random alignment
  by magnitude matrix (may want to get more data and more refined bins)

* updated peakfinder (boxcar smoothing w/3x pixels to reduce jitter, boost S/N) then fit with gaussian
  to the original spectra at peak points
    - additional lines (a few NaI, NeV, NeVI)

* reworked multi-line solution finder
  - solution accepted if it dominates the score of all solutions with 2+ additional lines detect of significant quality
        (obs_EW, total flux, etc)
  - added large emission line name and colored highlights to full 1D spectrum plot if a strong multiline solution is found
  - added name, rest wavelength, z, and EW to last line of stats text (upper left)
  (still tbd include this information in a text catalog)

* added hatch marks to skylines to disambiguate from possible emission line highlights

* fixed problem with HSC tract catalogs (entries in tracts corresponding to overlapping tiles do not correctly
  overlap (objects that appear in the overlap region are not necessarily recorded in the overlapping tracts).
  Now keeps all overlapping tracts, not just the one corresponding to the selected image tile.

* allow pdf to still be produced even if rsp1 (*2d.res file) is empty (or all zeroes). Data may be junk, but
  the pdf will still be produced.

* for classification scoring, feed in fluxes as e-18 (rather than e-17) ... the scaling is then very close to
  counts and the downstream logic can remain unchanged




1.4.0a3 [2018-05-25]
* add cat_bayesian package to handle Bayesian treatment of bid catalog objects (priors on likelihood of match to
    observation)
    - initial version of likelihood of being not random (as MDF based on Yaswant's work)
    - sorting possible matches by this prob then distance
    - added to top 3 bid match summaries

* change reported flux for bid catalog objects to magnitude for easier comparison
    (note: in some catalogs, the mag is provided by the catalog, in some it is calculated from the flux)
    uses v,g,r bands (in that order, when present)

* add global option DYNAMIC_MAG_APERTURE that, when true, allows the forced aperture placed on the imaging to calculate
    the magnitude to grow until the magnitude stabilizes or reaches the maximum of the error window. Currently set
    to a minimum of 0.5". Stabilization defined by either an increase in magnitude (dimming) or a change of less than
    0.05 mag. The aperture is sized to match on the cutout and the radius is reported next to the magnitude beneath the
    plot.

* update summing of spectra (upper right) to use RSP1 output when present

* update summed spectra plotting (upper right and full spectra, center) to standard plot (from step plotting)

* fixed(?) stackedCOSMOS and SHELA magnitude calcuations. Imaging counts are already in nJy and do not need to be
    converted.

* update contrast stretching for summed 2D cutout for better readability

* update SHELA and COSMOS aperture magnitude calculations (pixels are already in nJy and do not need conversion)
   (there is still some mismatch between reported mag and aperture mag, but it is closer)

* fixed missing S/N in upper left stats

* remove chi2 if not present (upper left stats)

* (temporarily?) turned off quality score until it can be re-scaled to flux (from counts)

* removed dead code from catalog classes (older versions that optionally produced individual pages for each bid catalog
    match, etc)


[older versions]
* changes not listed. See GitHub version control check-in comments
